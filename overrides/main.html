{% extends "base.html" %}

{% block extrahead %}
{{ super() }}
<meta name="custom-override" content="active">
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Create the workspace selector
    const selectorContainer = document.createElement('div');
    selectorContainer.className = 'workspace-selector-inline';
    
    const selectElement = document.createElement('select');
    selectElement.id = 'workspace-dropdown';
    selectElement.setAttribute('onchange', 'changeWorkspace(this.value)');
    selectElement.setAttribute('aria-label', 'Select workspace');
    
    // Add options
    const options = [
      { value: '/kb-platform/', text: 'Main' },
      { value: '/kb-engineering/', text: 'Engineering' },
      { value: '/kb-grc/', text: 'GRC' },
      { value: '/kb-networking/', text: 'Networking' }
    ];
    
    options.forEach(option => {
      const optionElement = document.createElement('option');
      optionElement.value = option.value;
      optionElement.textContent = option.text;
      selectElement.appendChild(optionElement);
    });
    
    selectorContainer.appendChild(selectElement);
    
    // Find where to insert the workspace selector - after the site title
    const headerTitle = document.querySelector('.md-header__title');
    if (headerTitle && headerTitle.parentNode) {
      headerTitle.parentNode.insertBefore(selectorContainer, headerTitle.nextSibling);
    }
    
    // Set the current workspace in dropdown
    const pathSegments = window.location.pathname.split('/');
    let repoName = '';
    
    if (pathSegments.length >= 2) {
      repoName = '/' + pathSegments[1] + '/';
    }
    
    for (let i = 0; i < selectElement.options.length; i++) {
      if (selectElement.options[i].value === repoName) {
        selectElement.selectedIndex = i;
        break;
      }
    }
  });
</script>
{% endblock %}